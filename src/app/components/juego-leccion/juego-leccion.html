<div class="game-wrapper">
        <div class="header">
            <h1>{{title}}</h1>
            <div class="progress-info">
                Pregunta {{getCurrentQuestionNumber()}} de {{getTotalQuestions()}}
            </div>
        </div>

        <div class="main-content" *ngIf="gameState === 'playing'">
            <!-- Área principal del juego -->
            <div class="game-container">
                <div class="question-area">
                    <!-- Reproductor de audio para preguntas de listening -->
                    <div class="audio-player" *ngIf="currentQuestion?.audio">
                        <div class="audio-controls">
                            <button class="play-button" (click)="playAudio()">
                                ▶️
                            </button>
                            <p style="margin-top: 0.5rem; color: #6b7280;">Escucha el audio</p>
                        </div>
                    </div>

                    <div class="question-text">
                        {{currentQuestion?.question}}
                    </div>
                </div>

                <div class="options">
                    <button 
                        *ngFor="let option of currentQuestion?.options" 
                        class="option-button"
                        [class.selected]="selectedAnswer === option"
                        [class.disabled]="showFeedback"
                        (click)="selectAnswer(option)">
                        {{option}}
                    </button>
                </div>

                <!-- Feedback de la respuesta -->
                <div class="feedback" 
                     [class.correct]="showFeedback && isAnswerCorrect"
                     [class.incorrect]="showFeedback && !isAnswerCorrect"
                     *ngIf="showFeedback">
                    <div *ngIf="isAnswerCorrect">
                        ✅ ¡Correcto! Muy bien.
                    </div>
                    <div *ngIf="!isAnswerCorrect">
                        ❌ Incorrecto. La respuesta correcta es: <strong>{{currentQuestion?.answer}}</strong>
                    </div>
                </div>

                <!-- Botones de acción -->
                <div class="action-buttons">
                    <button 
                        class="submit-button" 
                        (click)="submitAnswer()"
                        [disabled]="!selectedAnswer || showFeedback"
                        *ngIf="!showFeedback">
                        Responder
                    </button>
                    
                    <button 
                        class="next-button" 
                        (click)="nextQuestion()"
                        *ngIf="showFeedback">
                        {{currentQuestionIndex < questions.length - 1 ? 'Siguiente' : 'Finalizar'}}
                    </button>
                </div>
            </div>

            <!-- Tracker de preguntas -->
            <div class="questions-tracker">
                <div class="tracker-title">Progreso</div>
                <div class="questions-grid">
                    <div 
                        *ngFor="let status of questionStatus; let i = index"
                        class="question-number"
                        [class.current]="i === currentQuestionIndex && !status.answered"
                        [class.correct]="status.answered && status.correct"
                        [class.incorrect]="status.answered && !status.correct">
                        {{i + 1}}
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal de resultados finales -->
        <div class="modal-overlay" *ngIf="gameState === 'finished'">
            <div class="modal-content">
                <div class="modal-grade">{{getFinalGrade()}}</div>
                <div class="modal-score">{{score}} / {{questions.length}}</div>
                <div class="modal-percentage">{{((score / questions.length) * 100).toFixed(1)}}%</div>
                <div class="modal-message">{{getFinalMessage()}}</div>
                
                <div class="modal-buttons">
                    <button class="modal-button primary" (click)="restartGame()">
                        Jugar de nuevo
                    </button>
                    <button class="modal-button secondary" (click)="goToLessons()">
                        Volver a lecciones
                    </button>
                </div>
            </div>
        </div>
    </div>
